<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Pi Payment</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body>
  <h2>Test giao dịch Pi Network</h2>
  <button id="payBtn">Thanh toán 0.001 Pi</button>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ✅ Khởi tạo Pi SDK
      if (window.Pi) {
        Pi.init({ version: "2.0" });
        console.log("Pi SDK đã được khởi tạo");
      } else {
        alert("Không tìm thấy Pi SDK. Bạn cần chạy trang này trong Pi Browser.");
        return;
      }

      document.getElementById('payBtn').addEventListener('click', () => {
        Pi.createPayment({
          amount: 0.001,
          memo: "Giao dịch thử nghiệm",
          metadata: { purpose: "test" }
        }, {
          onReadyForServerApproval: (paymentId) => {
            alert("Chờ xác nhận: " + paymentId);
          },
          onReadyForServerCompletion: (paymentId, txid) => {
            alert("Giao dịch thành công!\nTXID: " + txid);
          },
          onCancel: (paymentId) => {
            alert("Giao dịch bị hủy: " + paymentId);
          },
          onError: (error, paymentId) => {
            alert("Lỗi: " + error + "\nPayment ID: " + paymentId);
          }
        });
      });
    });
  </script>
</body>
</html>
